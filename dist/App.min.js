!(function(){"use strict";function t(){}function e(){this.map=new t}function n(t,e){x(t),e.removeChild(t.$n)}function r(t,e,r){for(;r<t.length;)n(t[r++],e)}function o(t,e){for(var n=0;n<t.length;)x(t[n++]);e.textContent=""}function i(t,e){return t.$s===e.$s&&(e.$s.u(e,t),!0)}function u(t,e,n,r){null===r?a(t,e,n):c(t,e,n,r)}function c(t,e,n,r){for(;n<e.length;)t.insertBefore((e[n]=O(e[n])).$n,r),++n}function a(t,e,n){for(;n<e.length;)t.appendChild((e[n]=O(e[n])).$n),++n}function s(t,e,n){var r=document.createDocumentFragment(),o=k(t,r,e);return E(n,r),o}function f(t,e,n,o){for(var i=0;i<e.length&&i<n.length;i++)e[i]=$(n[i],e[i]);i<e.length?u(t,e,i,o):r(n,t,i)}function d(t,e,n){n.length?e.length?f(t,e,n,null):o(n,t):a(t,e,0)}function l(t,e,n,i){return t instanceof Array?(n?d(e,t,i):f(e.parentNode,t,i,e),e):n?(o(i,e),k(!0,e,t)):void r(i,e.parentNode,0)}function p(t,e,n){if(!(t instanceof Object))return e.nodeValue=A(t)?"":t,e}function h(t,e,n,r){var o=void 0;if(t&&i(o=r.$r||r,t))return t.$r=o,e}function v(e,n,r,o){this._boundActions=new t,this._parentInst=r,this.actions=o,this.props=n,this.render=e,this.bindSend=this.bindSend.bind(this),this.state=o.onInit(this),this.$n=I(this._instance=e(this))}function b(t,e,n,r){return new v(t,e,n,r)}function m(t,e){var n=t(e);return I(n),n}function g(t,e,n,r){var o=(e?b:m)(t,n||P,r,e);return o}function y(t,e,n,r){var o=e?r.updateProps(n):$(r,t(n));return o}function I(t){var e=t.$s.c(t);return t.$n=e,e.xvdom=t,e}function O(t){var e=t.$s,n=e.r.pop(t.key);return n?(e.u(t,n),n):(I(t),t)}function k(t,e,n){return n instanceof Array?(a(e,n,0),t?e:e.appendChild(j(""))):e.appendChild(n instanceof Object?I(n):j(A(n)?"":n))}function S(t,e,n,r){return(e instanceof Object?e instanceof Array?l(n,r,t,e):h(n,r,t,e):p(n,r,t))||s(t,n,r)}function $(t,e){return i(t,e)?t:(E(t.$n,(e=O(e)).$n),x(t),e)}function w(){if(firebase.auth().currentUser)return et.unsetCurrent(),firebase.auth().signOut();var t=new firebase.auth.GoogleAuthProvider;t.addScope("https://www.googleapis.com/auth/plus.login"),firebase.auth().signInWithPopup(t).catch((function(t){return console.error(t)}))}var D=navigator.serviceWorker;D&&D.register("../serviceWorker.js");var A=function(t){return null==t||t===!0||t===!1},P={},C={push:function(){},pop:function(){}};t.prototype=Object.create(null),e.prototype.push=function(t){var e=t.key,n=this.map;t.$x=n[e],n[e]=t},e.prototype.pop=function(t){var e=this.map[t];if(e)return this.map[t]=e.$x,e};var x=function(t){t.$s.r.push(t)},j=function(t){return document.createTextNode(t)},E=function(t,e){var n=t.parentNode;n&&n.replaceChild(e,t)};v.prototype.updateProps=function(t){var e=this.props;return this.props=t,this.actions.onProps?this.send("onProps",e):this.rerender(),this},v.prototype.bindSend=function(t){return this._boundActions[t]||(this._boundActions[t]=this.send.bind(this,t))},v.prototype.send=function(t,e){var n=void 0,r=this.actions[t];r&&(n=r(this,e))!=this.state&&(this.state=n,this.rerender())},v.prototype.rerender=function(){var t=$(this._instance,this.render(this));this._instance=t,t.$n.xvdom=this._parentInst};var N=function(t){return O(t).$n},L=function(t,e){return $(t.xvdom,e).$n},_=function(t){n(t.xvdom,t.parentNode)},T={createComponent:g,createDynamic:k,el:function(t){return document.createElement(t)},render:N,rerender:L,unmount:_,updateComponent:y,updateDynamic:S,Pool:e,DEADPOOL:C},J=function(t){return new Promise(function(e,n){var r=new window.XMLHttpRequest,o=localStorage.getItem("ticker:token:github");r.open("GET",t),o&&r.setRequestHeader("Authorization","token "+o),r.responseType="json",r.send(),r.onerror=n,r.onload=function(){var t=r.response;t?e("string"==typeof t?JSON.parse(t):t):n(new Error("loadJSON: empty response"))}})};J.setAccessToken=function(t){localStorage.setItem("ticker:token:github",t)};var z="ticker:storage",G=void 0;try{G=JSON.parse(localStorage.getItem(z))}catch(t){}G||localStorage.setItem(z,JSON.stringify(G=[]));var R=function(){var t=G.pop();t&&(localStorage.removeItem(t),U(t,!1))},q=function(t,e){for(var n=G.length;n--;)try{return void localStorage.setItem(t,e)}catch(t){R()}},U=function(t,e){var n=G.indexOf(t);n>=0&&G.splice(n,1),e&&G.unshift(t),q(z,JSON.stringify(G))},W=function(t){U(t,!0)},B={getItem:function(t){var e=localStorage.getItem(t);return e&&W(t),e},setItem:function(t,e){return q(t,e),W(t),e},getItemObj:function(t){var e=this.getItem(t),n=e&&JSON.parse(e);return n},setItemObj:function(t,e){return this.setItem(t,JSON.stringify(e)),e}},H=function(t){return t},M=function(t){return B.getItemObj(t)},Q=function(t){var e=t.url,n=t.cache,r=t.transform,o=void 0===r?H:r;return J(e).then(o).then(n?function(t){return B.setItemObj(n,t)}:H)},V=function(t){var e=t.get,n=t.query;return{localGet:function(t){return M(e(t).cache)},get:function(t){return Q(e(t))},localQuery:function(t){return M(n(t).cache)},query:function(t){return Q(n(t))}}},F=V({get:function(){return{url:"../static/db.json"}}}),K=(function(){function t(t){this.value=t}function e(e){function n(t,e){return new Promise(function(n,o){var c={key:t,arg:e,resolve:n,reject:o,next:null};u?u=u.next=c:(i=u=c,r(t,e))})}function r(n,i){try{var u=e[n](i),c=u.value;c instanceof t?Promise.resolve(c.value).then((function(t){r("next",t)}),(function(t){r("throw",t)})):o(u.done?"return":"normal",u.value)}catch(t){o("throw",t)}}function o(t,e){switch(t){case"return":i.resolve({value:e,done:!0});break;case"throw":i.reject(e);break;default:i.resolve({value:e,done:!1})}i=i.next,i?r(i.key,i.arg):u=null}var i,u;this._invoke=n,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(t){return this._invoke("next",t)},e.prototype.throw=function(t){return this._invoke("throw",t)},e.prototype.return=function(t){return this._invoke("return",t)},{wrap:function(t){return function(){return new e(t.apply(this,arguments))}},await:function(e){return new t(e)}}}(),function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}),X=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Y="ok:lastLoggedInUserId",Z=function(t){return firebase.database().ref("users/"+t)},tt=function(t){return B.setItemObj("ok:"+t.id,t)},et={current:function(){var t=B.getItem(Y);if(t)return this.localGet(t)},setCurrent:function(t){return B.setItem(Y,t)},unsetCurrent:function(){var t=this.current();t&&(B.setItemObj("ok:"+t.id,""),B.setItem(Y,""))},localGet:function(t){return B.getItemObj("ok:"+t)},save:function(t){return new Promise(function(e,n){Z(t.id).set(t,(function(r){return r?n(r):void e(tt(X({},t)))}))})},get:function(t){return new Promise(function(e,n){Z(t).once("value",(function(t){var r=t.val();return r?void e(tt(r)):n("Couldn't find User")}))})}},nt=void 0,rt=T.createComponent,ot=T.createDynamic,it=T.el,ut=T.updateComponent,ct=T.updateDynamic,at={c:function(t){var e=(t.c=rt(Pt,Pt.state,{user:t.a,db:t.b},t)).$n;return e},u:function(t,e){t.a===e.a&&t.b===e.b||(e.c=ut(Pt,Pt.state,{user:e.a=t.a,db:e.b=t.b},e.c))},r:T.DEADPOOL},st={c:function(t){var e,n=it("body");return e=it("div"),t.b=ot(!0,e,t.a),n.appendChild(e),t.d=ot(!1,n,t.c),e=it("button"),t.f=e,e.onclick=t.e,t.h=ot(!0,e,t.g),n.appendChild(e),n},u:function(t,e){var n;t.a!==e.a&&(e.b=ct(!0,e.a,e.a=t.a,e.b)),t.c!==e.c&&(e.d=ct(!1,e.c,e.c=t.c,e.d)),n=t.e,n!==e.e&&(e.f.onclick=n,e.e=n),t.g!==e.g&&(e.h=ct(!0,e.g,e.g=t.g,e.h))},r:T.DEADPOOL},ft={c:function(t){var e=(t.c=rt(Dt,Dt.state,{db:t.a,outfits:t.b},t)).$n;return e},u:function(t,e){t.a===e.a&&t.b===e.b||(e.c=ut(Dt,Dt.state,{db:e.a=t.a,outfits:e.b=t.b},e.c))},r:T.DEADPOOL},dt={c:function(t){var e,n,r=it("div");return e=it("table"),t.b=e,e.style=t.a,n=it("tbody"),t.d=ot(!0,n,t.c),e.appendChild(n),r.appendChild(e),r},u:function(t,e){var n;n=t.a,n!==e.a&&(e.b.style=n,e.a=n),t.c!==e.c&&(e.d=ct(!0,e.c,e.c=t.c,e.d))},r:T.DEADPOOL},lt={c:function(t){var e=(t.g=rt(wt,wt.state,{db:t.a,outfitId:t.b,outfit:t.c,selectedOutfitId:t.d,onSelect:t.e,onAddExclusion:t.f},t)).$n;return e},u:function(t,e){t.e===e.e&&t.d===e.d&&t.c===e.c&&t.b===e.b&&t.a===e.a&&t.f===e.f||(e.g=ut(wt,wt.state,{db:e.a=t.a,outfitId:e.b=t.b,outfit:e.c=t.c,selectedOutfitId:e.d=t.d,onSelect:e.e=t.e,onAddExclusion:e.f=t.f},e.g))},r:T.DEADPOOL},pt={c:function(t){var e,n=it("tr");return t.b=n,n.style=t.a,t.d=ot(!1,n,t.c),e=it("td"),t.f=ot(!0,e,t.e),n.appendChild(e),n},u:function(t,e){var n;n=t.a,n!==e.a&&(e.b.style=n,e.a=n),t.c!==e.c&&(e.d=ct(!1,e.c,e.c=t.c,e.d)),t.e!==e.e&&(e.f=ct(!0,e.e,e.e=t.e,e.f))},r:T.DEADPOOL},ht={c:function(t){var e=it("div");return t.b=ot(!1,e,t.a),t.d=ot(!1,e,t.c),e},u:function(t,e){t.a!==e.a&&(e.b=ct(!1,e.a,e.a=t.a,e.b)),t.c!==e.c&&(e.d=ct(!1,e.c,e.c=t.c,e.d))},r:T.DEADPOOL},vt={c:function(t){var e=it("a");return e.href="#",t.b=e,e.onclick=t.a,t.d=ot(!0,e,t.c),e},u:function(t,e){var n;n=t.a,n!==e.a&&(e.b.onclick=n,e.a=n),t.c!==e.c&&(e.d=ct(!0,e.c,e.c=t.c,e.d))},r:T.DEADPOOL},bt={c:function(t){var e=it("a");return e.href="#",t.b=e,e.onclick=t.a,e.appendChild(document.createTextNode("Remove outfits with these items")),e},u:function(t,e){var n;n=t.a,n!==e.a&&(e.b.onclick=n,e.a=n)},r:T.DEADPOOL},mt={c:function(t){var e,n=it("td");return t.b=n,n.itemId=t.a,n.itemType=t.c,n.onclick=t.d,n.style=t.e,e=it("img"),e.style="height: 150",t.g=e,e.src=t.f,n.appendChild(e),n},u:function(t,e){var n;n=t.a,n!==e.a&&(e.b.itemId=n,e.a=n),n=t.c,n!==e.c&&(e.b.itemType=n,e.c=n),n=t.d,n!==e.d&&(e.b.onclick=n,e.d=n),n=t.e,n!==e.e&&(e.b.style=n,e.e=n),n=t.f,n!==e.f&&(e.g.src=n,e.f=n)},r:T.DEADPOOL},gt=10,yt="background: #DDD;",It="border: 4px solid black;",Ot=["Yup","Nope","Maybe"],kt=["bottom","shirt","sweater","businessAttire"],St=kt.reduce((function(t,e){return t[e]=0,t}),{}),$t=function(t){return kt.reduce((function(e,n){return e+(t[n]&&1)}),0)<2},wt=function(t){var e=t.props,n=e.db,r=e.outfitId,o=e.outfit,i=e.selectedOutfitId,u=(e.onSelect,e.onAddExclusion,t.state.selectedItems),c=t.bindSend,a=r===i;return{$s:pt,a:a?yt:"",c:kt.map((function(t){var e=o[t];return{$s:mt,a:e,c:t,d:c("handleSelectItem"),e:u[t]===e?It:"",f:n.items[e].closet_image_url}})),e:a&&{$s:ht,a:!$t(u)&&{$s:bt,a:c("handleRemoveCombosWithSelected")},c:Ot.map((function(t){return{$s:vt,a:function(){return onAddToCategory(r,t)},c:t}}))}}};wt.state={onInit:function(t){t.props;return{selectedItems:St}},onProps:function(t){var e=t.props,n=e.selectedOutfitId,r=(e.outfit,e.outfitId),o=t.state;return{selectedItems:n===r?o.selectedItems:St}},handleSelectItem:function(t,e){var n=t.props,r=t.state.selectedItems,o=e.currentTarget,i=o.itemId,u=o.itemType;return setTimeout((function(){return n.onSelect(n.outfitId)})),{selectedItems:X({},r,K({},u,0===r[u]?+i:0))}}};var Dt=function(t){var e=t.props,n=e.db,r=e.outfits,o=t.state,i=(o.page,o.selectedOutfitId),u=t.bindSend;return{$s:dt,a:{borderCollapse:"collapse"},c:r.slice(0,gt).map((function(t){return{$s:lt,a:n,b:t,c:n.outfits[t],d:i,e:u("handleSelectOutfit"),f:function(){}}}))}},At=function(t){t.props,t.state;return{page:0,selectedOutfitId:0}};Dt.state={onInit:At,onProps:At,handleSelectOutfit:function(t,e){var n=t.state;return X({},n,{selectedOutfitId:e})},handleSelectItem:function(t,e){var n=t.state,r=e.currentTarget;if(r){var o=+r.parentNode.outfitId,i=r.itemType,u=+r.itemId,c=void 0;o!==n.selectedOutfitId?c=K({},i,u):(c=n.selectedItemIds,c[i]=c[i]?null:u),nt.setState(X({},n,{selectedOutfitId:o,selectedItemIds:c})),e.stopPropagation()}}};var Pt=function(t){var e=t.user,n=t.db;return{$s:st,a:e&&e.displayName,c:e&&n&&{$s:ft,a:n,b:e.uncategorized},e:w,g:e?"Sign out":"Sign in"}},Ct=function(t,e){return{$s:at,a:t,b:e}};firebase.initializeApp({apiKey:"AIzaSyB0wl7pEwIcb9VzHluaAQAZhOe1huyPxi8",authDomain:"outfit-knockout.firebaseapp.com",databaseURL:"https://outfit-knockout.firebaseio.com",storageBucket:"outfit-knockout.appspot.com",messagingSenderId:"60167804767"}),F.get().then((function(t){document.body=T.render(Ct(et.current(),t)),firebase.auth().onAuthStateChanged((function(e){return e?void et.get(e.uid).catch((function(){return et.save({id:e.uid,displayName:e.displayName,excludedCombos:{},uncategorized:Object.keys(t.outfits),yup:[],nope:[],maybe:[]})})).then((function(e){et.setCurrent(e.id),T.rerender(document.body,Ct(e,t))})):T.rerender(document.body,Ct(null,null))}))}))})();

